<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kitty.am - Hair Up</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { --gold: #D4AF37; --dark-bg: #050505; --card-bg: #111; --nav-bg: #000; }
        body { background-color: var(--dark-bg); color: white; font-family: 'Segoe UI', Roboto, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; }
        
        .phone-mockup { width: 360px; height: 740px; background-color: #000; border: 8px solid #222; border-radius: 40px; position: relative; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 25px 50px rgba(0,0,0,0.8); }
        
        header { padding: 20px; text-align: center; border-bottom: 1px solid #1a1a1a; background: #000; letter-spacing: 4px; color: var(--gold); font-weight: bold; }
        
        .main-content { flex: 1; overflow-y: auto; padding: 15px; padding-bottom: 80px; scrollbar-width: none; }
        .main-content::-webkit-scrollbar { display: none; }

        /* –ü—Ä–æ–º–æ –±–ª–æ–∫ Hair Up */
        .hair-up-card { background: linear-gradient(145deg, #1a1a1a, #000); border: 1px solid var(--gold); border-radius: 20px; padding: 20px; margin-bottom: 20px; text-align: center; }
        .hair-up-card h2 { margin: 0; font-size: 28px; background: linear-gradient(to right, #D4AF37, #FFF); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* –ü–æ—Å—Ç—ã */
        .post-card { background: var(--card-bg); border-radius: 15px; overflow: hidden; margin-bottom: 20px; border: 1px solid #222; }
        .post-card img { width: 100%; aspect-ratio: 1/1; object-fit: cover; display: block; }
        .post-info { padding: 12px; display: flex; justify-content: space-between; align-items: center; }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        nav { position: absolute; bottom: 0; width: 100%; height: 70px; background: var(--nav-bg); display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #1a1a1a; }
        .nav-item { color: #555; cursor: pointer; text-align: center; font-size: 10px; transition: 0.3s; }
        .nav-item.active { color: var(--gold); transform: translateY(-3px); }
        .nav-icon { font-size: 20px; display: block; margin-bottom: 4px; }

        /* –ö–Ω–æ–ø–∫–∏ –∏ —Ñ–æ—Ä–º—ã */
        .auth-form { display: flex; flex-direction: column; gap: 12px; padding-top: 50px; }
        .input-style { background: #1a1a1a; border: 1px solid #333; color: #fff; padding: 12px; border-radius: 10px; outline: none; }
        .btn-gold { background: var(--gold); color: #000; border: none; padding: 12px; border-radius: 10px; font-weight: bold; cursor: pointer; }
        
        .notification { position: absolute; top: 20px; width: 80%; left: 10%; background: var(--gold); color: #000; padding: 10px; border-radius: 10px; text-align: center; font-size: 12px; font-weight: bold; z-index: 1000; display: none; }
    </style>
</head>
<body>

<div class="phone-mockup">
    <div id="toast" class="notification"></div>
    <header>KITTY.AM</header>
    
    <div class="main-content" id="screen-content">
        </div>

    <nav>
        <div class="nav-item active" onclick="showScreen('feed')"><span class="nav-icon">‚ú®</span>–ü–†–ê–ô–î</div>
        <div class="nav-item" onclick="showScreen('profile')"><span class="nav-icon">üê±</span>–ü–†–û–§–ò–õ–¨</div>
        <div class="nav-item" onclick="showScreen('settings')"><span class="nav-icon">‚öôÔ∏è</span>–û–ü–¶–ò–ò</div>
    </nav>
</div>

<script>
    const SB_URL = 'https://jfvpauofczfliqjpupfp.supabase.co';
    const SB_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmdnBhdW9mY3pmbGlxanB1cGZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3NjQ2MTYsImV4cCI6MjA4NDM0MDYxNn0.1CrMZ4YtxOoAjvEgMg8ffQdl7xldmDkKAFLnukaO6nE';
    const supabaseClient = supabase.createClient(SB_URL, SB_KEY);

    let currentUser = null;
    let postsData = [];

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    async function init() {
        const { data } = await supabaseClient.auth.getSession();
        currentUser = data.session?.user || null;
        showScreen('feed');
    }

    const screens = {
        feed: async () => {
            const { data } = await supabaseClient.from('posts').select('*').order('created_at', { ascending: false });
            postsData = data || [];
            
            let html = `
                <div class="hair-up-card">
                    <h2>HAIR UP</h2>
                    <p style="color: #888; font-size: 12px;">’é’°÷Ä’Ω’•÷Ä’® ’æ’•÷Ä÷â ’î’∏ ’°’∂’¥’∏’º’°’∂’°’¨’´ ÷Ü’∏’ø’∏’Ω’•’©’®</p>
                    <button class="btn-gold" style="width: auto; padding: 5px 15px;" onclick="notify('–°–∫–æ—Ä–æ –æ—Ç–∫—Ä—ã—Ç–∏–µ –∑–∞–ø–∏—Å–∏!')">–£–ó–ù–ê–¢–¨ –ë–û–õ–¨–®–ï</button>
                </div>
            `;
            
            html += postsData.map(post => `
                <div class="post-card">
                    <div style="padding: 10px; font-size: 11px; color: #555;">@${post.author || 'kitty_user'}</div>
                    <img src="${post.image_url}" onerror="this.src='https://via.placeholder.com/300?text=No+Image'">
                    <div class="post-info">
                        <span onclick="notify('–ú—É—Ä!')" style="cursor:pointer">üêæ ${post.likes || 0}</span>
                    </div>
                </div>
            `).join('');
            return html;
        },
        profile: () => {
            if (!currentUser) return renderAuthForm();
            return `
                <div style="text-align:center; padding-top:40px;">
                    <div style="font-size:60px;">üê±</div>
                    <h3>–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å</h3>
                    <p style="color:#555">${currentUser.email}</p>
                    <button class="btn-gold" onclick="notify('–ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫–æ—Ä–æ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç')">+ –ù–û–í–´–ô –ü–û–°–¢</button>
                </div>
            `;
        },
        settings: () => {
            if (!currentUser) return `<p style="text-align:center; padding-top:100px; color:#555;">–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</p>`;
            return `
                <div style="padding: 20px; text-align:center;">
                    <button class="btn-gold" style="background:#441111; color:white;" onclick="logout()">–í–´–ô–¢–ò</button>
                </div>
            `;
        }
    };

    async function showScreen(name) {
        const content = document.getElementById('screen-content');
        content.innerHTML = '<p style="text-align:center; padding-top:100px; color:var(--gold);">–ú—É—Ä–ª—ã—á–µ–º...</p>';
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫–∏ –º–µ–Ω—é
        document.querySelectorAll('.nav-item').forEach((item, idx) => {
            item.classList.toggle('active', (name === 'feed' && idx === 0) || (name === 'profile' && idx === 1) || (name === 'settings' && idx === 2));
        });

        const html = await screens[name]();
        content.innerHTML = html;
    }

    function renderAuthForm() {
        return `
            <div class="auth-form">
                <h3 style="text-align:center; color:var(--gold);">–í—Ö–æ–¥ –≤ –ü—Ä–∞–π–¥</h3>
                <input type="email" id="auth-email" class="input-style" placeholder="Email">
                <input type="password" id="auth-pass" class="input-style" placeholder="–ü–∞—Ä–æ–ª—å">
                <button class="btn-gold" onclick="login()">–í–û–ô–¢–ò</button>
                <button style="background:none; border:none; color:#555; font-size:11px;" onclick="register()">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
            </div>
        `;
    }

    async function login() {
        const email = document.getElementById('auth-email').value;
        const password = document.getElementById('auth-pass').value;
        const { error } = await supabaseClient.auth.signInWithPassword({ email, password });
        if (error) alert(error.message); else location.reload();
    }

    async function register() {
        const email = document.getElementById('auth-email').value;
        const password = document.getElementById('auth-pass').value;
        const { error } = await supabaseClient.auth.signUp({ email, password });
        if (error) alert("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è!"); else alert("–£—Å–ø–µ—Ö!");
    }

    async function logout() {
        await supabaseClient.auth.signOut();
        location.reload();
    }

    function notify(msg) {
        const t = document.getElementById('toast');
        t.innerText = msg;
        t.style.display = 'block';
        setTimeout(() => t.style.display = 'none', 2500);
    }

    init();
</script>

</body>
</html>