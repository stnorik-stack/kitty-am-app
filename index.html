<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kitty.am - V5</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { --gold: #D4AF37; --bg: #000; --card: #111; }
        * { box-sizing: border-box; }
        body { background: var(--bg); color: white; font-family: sans-serif; margin: 0; display: flex; justify-content: center; height: 100vh; overflow: hidden; }
        
        .app { width: 100%; max-width: 500px; display: flex; flex-direction: column; height: 100%; border-left: 1px solid #222; border-right: 1px solid #222; }
        
        header { padding: 15px; text-align: center; color: var(--gold); font-weight: bold; font-size: 20px; letter-spacing: 2px; border-bottom: 1px solid #222; }
        
        nav { display: flex; background: #0a0a0a; border-bottom: 1px solid #222; }
        .nav-btn { flex: 1; padding: 12px; text-align: center; color: #555; cursor: pointer; font-size: 12px; text-transform: uppercase; }
        .nav-btn.active { color: var(--gold); border-bottom: 2px solid var(--gold); }

        .content { flex: 1; overflow-y: auto; padding: 15px; }

        .promo { background: linear-gradient(45deg, #111, #000); border: 1px solid var(--gold); border-radius: 15px; padding: 20px; margin-bottom: 20px; text-align: center; }
        .promo h2 { color: var(--gold); margin: 0 0 10px; }

        .card { background: var(--card); border-radius: 12px; overflow: hidden; margin-bottom: 20px; border: 1px solid #222; }
        .card img { width: 100%; display: block; max-height: 400px; object-fit: cover; }
        .card-footer { padding: 12px; display: flex; justify-content: space-between; align-items: center; background: #151515; }

        .btn-gold { background: var(--gold); color: #000; border: none; padding: 10px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; width: 100%; }
        .toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: var(--gold); color: #000; padding: 10px 20px; border-radius: 20px; z-index: 1000; display: none; font-weight: bold; }
    </style>
</head>
<body>

<div class="app">
    <div id="toast" class="toast"></div>
    <header>KITTY.AM V5</header>
    
    <nav>
        <div class="nav-btn active" onclick="tab('feed', this)">–õ–µ–Ω—Ç–∞</div>
        <div class="nav-btn" onclick="tab('profile', this)">–ü—Ä–æ—Ñ–∏–ª—å</div>
        <div class="nav-btn" onclick="tab('settings', this)">–û–ø—Ü–∏–∏</div>
    </nav>

    <div class="content" id="main">
        <div style="text-align:center; margin-top:50px; color:var(--gold);">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∞–π–¥–∞...</div>
    </div>
</div>

<script>
    const SB_URL = 'https://jfvpauofczfliqjpupfp.supabase.co';
    const SB_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmdnBhdW9mY3pmbGlxanB1cGZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3NjQ2MTYsImV4cCI6MjA4NDM0MDYxNn0.1CrMZ4YtxOoAjvEgMg8ffQdl7xldmDkKAFLnukaO6nE';
    const db = supabase.createClient(SB_URL, SB_KEY);

    let user = null;

    async function start() {
        const { data } = await db.auth.getSession();
        user = data.session?.user || null;
        tab('feed', document.querySelector('.nav-btn'));
    }

    const views = {
        feed: async () => {
            const { data } = await db.from('posts').select('*').order('created_at', { ascending: false });
            let posts = data || [];
            let html = `
                <div class="promo">
                    <h2>HAIR UP</h2>
                    <p style="font-size:12px; color:#888;">’é’°÷Ä’Ω’•÷Ä’® ’æ’•÷Ä÷â ’î’∏ ’°’∂’¥’∏’º’°’∂’°’¨’´ ÷Ü’∏’ø’∏’Ω’•’©’®</p>
                    <button class="btn-gold" onclick="msg('–ó–∞–ø–∏—Å—å —Å–∫–æ—Ä–æ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è!')">–£–ó–ù–ê–¢–¨ –ë–û–õ–¨–®–ï</button>
                </div>
            `;
            html += posts.map(p => `
                <div class="card">
                    <img src="${p.image_url}">
                    <div class="card-footer">
                        <span style="color:var(--gold); font-weight:bold;">üêæ ${p.likes || 0}</span>
                        <span style="color:#555; font-size:11px;">@${p.author || 'kitty'}</span>
                    </div>
                </div>
            `).join('');
            return html;
        },
        profile: () => {
            if (!user) return '<div style="padding:20px; text-align:center;"><p>–ù—É–∂–Ω–æ –≤–æ–π—Ç–∏</p><button class="btn-gold" onclick="location.reload()">–û–ë–ù–û–í–ò–¢–¨</button></div>';
            return `<div style="padding:20px; text-align:center;"><h3>${user.email}</h3><button class="btn-gold">+ –ü–û–°–¢</button></div>`;
        },
        settings: () => '<div style="padding:20px;"><button class="btn-gold" style="background:#441111; color:white;" onclick="db.auth.signOut().then(()=>location.reload())">–í–´–ô–¢–ò</button></div>'
    };

    async function tab(name, el) {
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
        const container = document.getElementById('main');
        container.innerHTML = '<div style="text-align:center; padding-top:50px; color:var(--gold);">–ú—É—Ä–ª—ã—á–µ–º...</div>';
        container.innerHTML = await views[name]();
    }

    function msg(t) {
        const s = document.getElementById('toast');
        s.innerText = t; s.style.display = 'block';
        setTimeout(() => s.style.display = 'none', 2500);
    }

    start();
</script>
</body>
</html>